language: java
sudo: false
jdk: openjdk8

env:
  - DOCKER_IMAGEM=s1dn3y/alura-forun

addons:
  sonarcloud:
    organization: teste-alura
    token:
      secure: "R5xWteJluIKeRG/k+1SN3JFuK5GDgQTn+nwOHS5BJqNCytpJu9ETXyeV0jfMy27SQkkNKI5nWyZrW/IXdByTWXcGzHu1WOpmlYj6xGe/ucEYexlL1BlaZmD7FNnGI3HxXv5cqlLhhgflr+azdHzI5IHyNHrzDY1wVc54BZdQfZv84Vg7iDrhx/uUdGgcrLmcEdS/mOfqDdP2p6PRgfCyswpIOu47Fi8qM9OaVx4fBxcq/4jrHj7V5jrTe3AINEncfoGQsTu8OxVE9qw+KopmlbGcjBfZZoUDaehGQ41gK70xXppP2nEjS/kE01Igx17JI9ZrCd26xxAJqDNXafMKolVYtSDW/IwaaePH9PHO5pFrByVx8Q01LXbKhO6JfINwcwsu6uAV/PzuZYIcHQ1s/mZrOSmMQrZgG6ZHL2cBENKMiXqflcb7B4BRYLdvAkChpwNJ+ohy3OuBqxZsdzFB8q+j5pKAI3Gi2ukVYrdNDBGO+layrSm1etr0kpgcQecsmFLlGkpCYBcpnomLGX4vuX191lfC+D/G+A9LwrB0lEHSicJQDt2O791db5He2tvrn+NbPjjgQQTZ/F0jBjR21Dgc7q1LV6ftlVEGfoRILslDLOL0a1C/gsA3R5mfrSGXJJa2OviJO9zvTpGcMtfukYZ4CwgPdF6yaSYeG7IoF1M="

services:
  - docker

script:
  - mvn clean verify jacoco:report coveralls:report sonar:sonar -Dsonar.projectKey=teste-alura_forun

deploy:
  skip_cleanup: true
  provider: script
  script: bash docker-push.sh
  on:
    all_branches: true # necess√°rio pq o travis trata tags como branches

notifications:
  slack:
    rooms:
      secure: IqRxqopasPRep4bbwiuDV/hTSjZB5idOtt84Tf1zjKGmVRR0kBUYEUDOKez7dbsOzTAntbCPXkFU+VdnXO5U+/OdLM7qJSlnBzGgkjvwFqa+EVLILA+0VhqLPK7WuN4CbhSZF7H1KRV5HsxBO9NhDpDbypVFaY8F4AgV4VDywN2w12oj1AMUs/SIctQktq5bj5cuQz+5jlDoFpCMRXYMg7ftIzN7vPoGAVNMjLSbJWgmcXTHf2yfYkOcSKdh3ZpUP3Ox3fYijnqk+bFou07WSZL1MWCPgy7T60FwyWM8IVyb2OjI8ndyAlsmE1gEEPyOJXHZaJmkkMp83EndJ4v0bfgiGTkFLaMPF9TlX+DgRtXkD5n9HM9uL740SYa6VrxZToLSzU7kaasoCBRSheVLmrDOijoisuW9iVAtqKwhGNtIlbbO9d9DC+zoYP1l4RyCzDCXOir4cun8a85lRmLhs7NT0C+uj7aEnhlIGs2G5uYxKTtWmpui+wC838DRPkuTt8ks3ol1c/qdx01Sd5nziUI4ExfKBNd/U68my8nyPkuhTAKZZNuIL/EjW/ajLEwzactoo/grgolcA7mmdv1l7Js0dFypPhd02nr5Mj/E1OThHbszOlAbA06Zmfa2d/s35oLc6zXMGxNrommiLTsnmuiAazmHdQPityBb8Lanwlo=
    on_success: always

#notifications:
#  email:
#    if: branch = develop
#    recipients:
#      - devs@servidor.com.br
#    on_success: never
#    on_failure: always
#
#  email:
#    if: branch = release
#    recipients:
#      - devs@servidor.com.br
#      - sm@servidor.com.br
#      - qa@servidor.com.br
#    on_success: change
#    on_failure: always
#
#  email:
#    if: branch = master
#    recipients:
#      - sm@servidor.com.br
#      - po@servidor.com.br
#    on_success: change
#    on_failure: always
